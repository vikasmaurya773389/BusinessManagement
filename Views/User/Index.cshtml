@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@model List<BusinessManagement.Models.User>

@{
    ViewData["Title"] = "USERS";
    var errorMseeage = TempData["errorMessage"]?.ToString();
    var successMessage = TempData["successMessage"]?.ToString();
}
<style>
    table {
        box-shadow: 0px 4px 8px 0px rgba(0, 0, 0, 0.2);
    }
</style>


@if (!string.IsNullOrWhiteSpace(@successMessage))
{
    <div class="alert hides alert-success">
        <b>Success: </b>@successMessage
        <button type="button" class="btn-close float-end" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}
else if (!string.IsNullOrWhiteSpace(errorMseeage))
{
    <div class="alert hides alert-danger">
        <b>Error: </b>@errorMseeage
        <button type="button" class="btn-close float-end" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}
<div class="row">
    <div class="container-fluid">
        <form>
            <b style="font-size:30px;">@ViewData["Title"]?.ToString()</b> <button asp-action="Create" asp-controller="User" class="btn rounded-pill btn-primary mb-3" style="float:right;">Add New User</button>

            <table class="table">
                <thead>
                    <tr class="table-active table-bordered table-hover">
                        <th>Name</th>
                        <th>User Name</th>
                        <th>Contact Number</th>
                        <th>Designation</th>
                        <th>Email</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>

                    @foreach (var user in Model)
                    {
                        <tr>
                            <td>@user.Name</td>
                            <td>@user.UserName</td>
                            <td>@user.ContactNumber</td>
                            <td>@user.Designation</td>
                            <td>@user.EmailId</td>
                            <td>
                                <div class="btn-group btn-group-sm">
                                    <a asp-controller="user" asp-action="View" asp-route-id="@user.UserId" title="View" class="btn rounded-pill btn-success"><i class="fa-solid fa-eye"></i></a>
                                    &nbsp;
                                    <a asp-controller="user" asp-action="Edit" asp-route-id="@user.UserId" title="Edit" class="btn rounded-pill btn-primary"><i class="fa-solid fa-pencil"></i></a>
                                    &nbsp;
                                    <a onclick="confirmDelete(@user.UserId)" title="Delete" class="btn rounded-pill btn-danger"><i class="fa-solid fa-trash"></i></a>
                                </div>
                            </td>
                        </tr>
                    }

                </tbody>
            </table>
        </form>
    </div>
</div>

<!-- Sweet Alert library -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.css" />

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
    //function confirmDelete(UserId) {
    //    Swal.fire({
    //        title: 'Are you sure?',
    //        text: "You won't be able to revert this!",
    //        icon: 'warning',
    //        showCancelButton: true,
    //        confirmButtonColor: '#3085d6',
    //        cancelButtonColor: '#d33',
    //        confirmButtonText: 'Yes, delete it!',
    //        cancelButtonText: 'Cancel'
    //    }).then((result) => {
    //        if (result.isConfirmed) {
    //            window.location.href = "/User/ConfirmDelete?id=" + UserId;
    //        } else {
    //            window.location.href = "/User/Index";
    //        }
    //    });
    //}


    function confirmDelete(UserId) {
        Swal.fire({
            title: 'Are you sure?',
            text: "You want to delete this User!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Yes, delete it!',
            cancelButtonText: 'Cancel'
        }).then((result) => {
            if (result.isConfirmed) {
                // Perform the delete action
                deleteAction(UserId);
            }
        });
    }

    function deleteAction(UserId) {
        // Make an AJAX request or perform the necessary actions to delete the user
        // Once the delete operation is successful, show the success message
        $.ajax({
            url: '/User/ConfirmDelete',
            type: 'GET',
            data: { id: UserId },
            success: function (response) {
                
                Swal.fire({
                    title: 'Deleted!',
                    text: 'The user has been deleted successfully.',
                    icon: 'success',
                    timer: 3000,
                    timerProgressBar: true,
                    showConfirmButton: false
                }).then((result) => {
                    // Redirect to the index page
                    window.location.href = "/User/Index";
                });
               
            },
            error: function () {
                Swal.fire({
                    title: 'Error!',
                    text: 'An error occurred while deleting the user.',
                    icon: 'error',
                    timer: 3000,
                    timerProgressBar: true,
                    showConfirmButton: false
                });
            }
        });
    }




    $(document).ready(function () {
        setTimeout(function () {
            $('.hides').hide();
        }, 5000); // Hide the divs after 5 seconds (5000 milliseconds)
    });
</script>

























@*
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@model List<BusinessManagement.Models.User>

@{
    ViewData["Title"] = "USERS";
    var errorMseeage = TempData["errorMessage"]?.ToString();
    var successMessage = TempData["successMessage"]?.ToString();
}
<style>
    table {
        box-shadow: 0px 4px 8px 0px rgba(0, 0, 0, 0.2);
    }
</style>


@if (!string.IsNullOrWhiteSpace(@successMessage))
{
    <div class="alert hides alert-success">
        <b>Success: </b>@successMessage
        <button type="button" class="btn-close float-end" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}
else if (!string.IsNullOrWhiteSpace(errorMseeage))
{
    <div class="alert hides alert-danger">
        <b>Error: </b>@errorMseeage
        <button type="button" class="btn-close float-end" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}
<div class="row">
    <div class="container-fluid">
        <form>
            <b style="font-size:30px;">@ViewData["Title"]?.ToString()</b> <button asp-action="Create" asp-controller="User" class="btn rounded-pill btn-primary mb-3" style="float:right;">Add New User</button>

            <table class="table">
                <thead>
                    <tr class="table-active table-bordered table-hover">
                        <th>Name</th>
                        <th>User Name</th>
                        <th>Contact Number</th>
                        <th>Designation</th>
                        <th>Email</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>

                    @foreach (var user in Model)
                    {
                        <tr>
                            <td>@user.Name</td>
                            <td>@user.UserName</td>
                            <td>@user.ContactNumber</td>
                            <td>@user.Designation</td>
                            <td>@user.EmailId</td>
                            <td>
                                <div class="btn-group btn-group-sm">
                                    <a asp-controller="user" asp-action="View" asp-route-id="@user.UserId" title="View" class="btn rounded-pill btn-success"><i class="fa-solid fa-eye"></i></a>
                                    &nbsp;
                                    <a asp-controller="user" asp-action="Edit" asp-route-id="@user.UserId" title="Edit" class="btn rounded-pill btn-primary"><i class="fa-solid fa-pencil"></i></a>
                                    &nbsp;
                                    <a onclick="confirmDelete(@user.UserId)" title="Delete" class="btn rounded-pill btn-danger"><i class="fa-solid fa-trash"></i></a>
                                </div>
                            </td>
                        </tr>
                    }

                </tbody>
            </table>
        </form>
    </div>
</div>




<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
    function confirmDelete(UserId) {
        var confirmation = confirm("Are you sure you want to delete this User?");
        if (confirmation === true) {
            window.location.href = "/User/ConfirmDelete?id=" + UserId;
        } else if (confirmation === false) {
            window.location.href = "/User/Index";
        }
    }




    $(document).ready(function () {
        setTimeout(function () {
            $('.hides').hide();
        }, 5000); // Hide the divs after 5 seconds (5000 milliseconds)
    });


</script>








*@













